<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <title>çƒ§å†™ | Elektrobit æ–‡æ¡£ä¸­å¿ƒ</title><meta name="description" content="è¿™é‡Œæœ‰æ‰€æœ‰ä½ å¸Œæœ›é˜…è¯»åˆ°çš„Elektrobitå…¬å¼€æ–‡æ¡£ä»¥åŠå„ç§å„æ ·çš„AUTOSARçŸ¥è¯†ğŸ‘">
    <link rel="preload" href="/ifs_shanghai_doc/assets/js/runtime~app.dd0e7869.js" as="script"><link rel="preload" href="/ifs_shanghai_doc/assets/css/styles.13e813b5.css" as="style"><link rel="preload" href="/ifs_shanghai_doc/assets/js/812.60586aed.js" as="script"><link rel="preload" href="/ifs_shanghai_doc/assets/js/app.3beca432.js" as="script">
    <link rel="stylesheet" href="/ifs_shanghai_doc/assets/css/styles.13e813b5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/ifs_shanghai_doc/zh/" class=""><img class="logo" src="/ifs_shanghai_doc/images/logo.png" alt="Elektrobit æ–‡æ¡£ä¸­å¿ƒ"><span class="site-name can-hide">Elektrobit æ–‡æ¡£ä¸­å¿ƒ</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/ifs_shanghai_doc/zh/eb_corbos_starterkit/introduction.md" class="nav-link" aria-label="EB corbos StarterKit"><!--[--><!--]--> EB corbos StarterKit <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é€‰æ‹©è¯­è¨€"><span class="title">é€‰æ‹©è¯­è¨€</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="é€‰æ‹©è¯­è¨€"><span class="title">é€‰æ‹©è¯­è¨€</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/ifs_shanghai_doc/" class="nav-link" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a aria-current="page" href="/ifs_shanghai_doc/zh/eb_xelor/user_guide/flashing.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="ç®€ä½“ä¸­æ–‡"><!--[--><!--]--> ç®€ä½“ä¸­æ–‡ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/ifs_shanghai_doc/zh/eb_corbos_starterkit/introduction.md" class="nav-link" aria-label="EB corbos StarterKit"><!--[--><!--]--> EB corbos StarterKit <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é€‰æ‹©è¯­è¨€"><span class="title">é€‰æ‹©è¯­è¨€</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="é€‰æ‹©è¯­è¨€"><span class="title">é€‰æ‹©è¯­è¨€</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/ifs_shanghai_doc/" class="nav-link" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a aria-current="page" href="/ifs_shanghai_doc/zh/eb_xelor/user_guide/flashing.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="ç®€ä½“ä¸­æ–‡"><!--[--><!--]--> ç®€ä½“ä¸­æ–‡ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="çƒ§å†™" tabindex="-1"><a class="header-anchor" href="#çƒ§å†™" aria-hidden="true">#</a> çƒ§å†™</h1><p>EB xelorä»¥ConanåŒ…å½¢å¼æä¾›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä½ å¯ä»¥æ‰‹åŠ¨æˆ–è€…é€šè¿‡è°ƒç”¨pythonåº“çš„æ–¹å¼è¿›è¡Œçƒ§å†™ã€‚</p><p>å½“å‰åªåœ¨åŸç”ŸLinuxç¯å¢ƒè¿›è¡Œè¿‡éªŒè¯ï¼ŒCygwinæˆ–è€…è™šæ‹Ÿæœºç¯å¢ƒï¼Œæˆ–è€…æ˜¯å®¹å™¨ä¸­ï¼Œç†è®ºä¸Šä¹Ÿå¯è¡Œã€‚</p><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>æ‰€éœ€çš„Pythonåº“åˆ—åœ¨ &#39;/tools/lib/python/ebcoreflashlib/&#39; ç›®å½•ä¸‹çš„requirements.txtæ–‡ä»¶ä¸­.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> pip3 <span class="token function">install</span> -r requirements.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Linuxç¯å¢ƒä¸‹ï¼Œä»¥ä¸‹åŒ…ä¹Ÿæ˜¯å¿…é¡»çš„ï¼š fastboot, ethtool, expect</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y fastboot <span class="token function">ethtool</span> <span class="token function">expect</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>å½“å‰åªåœ¨Linuxç¯å¢ƒè¿›è¡Œè¿‡éªŒè¯ï¼Œå¦‚æœä½ åœ¨Windoesç¯å¢ƒè®¾ç½®äº†fastbootçš„PATHç¯å¢ƒå˜é‡ï¼Œç†è®ºä¸Šä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p></div><h1 id="ä½¿ç”¨æä¾›çš„åº“æ–‡ä»¶çƒ§å†™" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æä¾›çš„åº“æ–‡ä»¶çƒ§å†™" aria-hidden="true">#</a> ä½¿ç”¨æä¾›çš„åº“æ–‡ä»¶çƒ§å†™</h1><h2 id="rcar-h3çš„åº“æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#rcar-h3çš„åº“æ–‡ä»¶" aria-hidden="true">#</a> Rcar H3çš„åº“æ–‡ä»¶</h2><div class="custom-container tip"><p class="custom-container-title">çƒ§å†™H3ä¹‹å‰éœ€è¦æ³¨æ„çš„äº‹</p><p>æ£€æŸ¥H3 ç›®æ ‡æ¿ä¸Šæœ‰æ­£ç¡®çš„CPLD (Complex Programmable Logic Device, used for configuring the SoC&#39;s mode pins) è½¯ä»¶ç‰ˆæœ¬(20161005)ã€‚</p><p>å¦‚æœè½¯ä»¶ç‰ˆæœ¬ä½äº20161005ï¼Œè¯·å…ˆå‡çº§ã€‚ å¦‚æœè½¯ä»¶ç‰ˆæœ¬é«˜äº20161005, è€ƒè™‘åˆ°å¯èƒ½ä¼šæœ‰æ—¶é’Ÿé—®é¢˜ï¼Œä¸æ¨èé™çº§å¤„ç† (æœ‰å¯èƒ½å¯¼è‡´ç›®æ ‡æ¿æ— æ³•å¯åŠ¨)ã€‚</p></div><p>ä½œä¸ºå‰ææ¡ä»¶çš„æ˜¯ï¼Œä½ éœ€è¦æå‰å‡†å¤‡å¥½Renesas H3çš„flash writerå¹¶ä¸”flasherå¯ä»¥è°ƒç”¨åˆ°ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰‹åŠ¨ä¸‹è½½flash writerè¿›è¡ŒéªŒè¯ã€‚</p><p>flash writeræºä»£ç å¯ä»¥ä» https://github.com/renesas-rcar/flash_writer è·å–ã€‚</p><p>å¦‚æœç”±äºè·¯å¾„é—®é¢˜æ— æ³•è®¾ç½®åœ¨manifestä¸­ï¼Œä½ å¯ä»¥å‘½ä»¤è¡Œè°ƒç”¨çš„æ—¶å€™ç»™å…¥å‚æ•°ã€‚</p><p>The flash library provides an interface for erasing and writing images to QSPI and eMMC flash memory in an automated way, thus supporting usage on personal computers as well as in an automated toolchain (e.g. a Jenkins setup). It can be configured via a JSON file and command line options.</p><p>Data transmission is possible over serial interface for QSPI, over fastboot/UDP for eMMC as soon as u-boot is installed, and over SSH as soon as Linux is booted. The serial connection is also required for initializing fastboot transmission. The flashing library uses the pexpect Python module to analyse the output patterns of the software running on the target. The output is sent over the serial interface. The flashing library implements the flow control to stop the target in the u-boot if required.</p><p>It is possible to flash only single memory areas or groups of multiple areas.</p><p>The config file can be validated against a JSON schema.</p><p>During the write process it can be necessary to operate some of the board&#39;s dip switches. The library can trigger this automatically when given a set of callback functions doing the actual switching (use --hw parameter). If you do not work in an automated test environment, you need to apply the switches as described in Step 1 of [ManualFlashingH3].</p><div class="custom-container tip"><p class="custom-container-title">æ³¨æ„</p><p>Remove the board&#39;s main power before changing the mode switches. The mode switches are read by the CPLD when the board first gets power, not when turning it on by pressing the power button.</p></div><p>The library is implemented in Python and can be called directly from another Python program or from the command line.</p><p><strong>Prerequisites</strong> for executing the flasher script:</p><ul><li>Serial connection to the board</li><li>Ethernet (for fastboot eMMC flashing and SSH file transfer)</li><li>Image files available (QSPI images have to be in .srec format)</li><li>Renesas Flash Writer for serial flashing</li><li>Python 3 installed (at least version 3.8)</li><li>Configuration file according to schema defined in <code>EBcore-main/tools/lib/python/ebcoreflashlib/JSON_flashlayout_schema.json</code></li></ul><h2 id="s32gçš„åº“æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#s32gçš„åº“æ–‡ä»¶" aria-hidden="true">#</a> S32Gçš„åº“æ–‡ä»¶</h2><p>ä½œä¸ºå‰ææ¡ä»¶ï¼Œä½ éœ€è¦ä»NXPè·å–S32G flashing toolï¼Œç„¶åå®‰è£…ã€‚</p><p>flashing toolè·¯å¾„éœ€è¦åœ¨manifestæ–‡ä»¶ä¸­è®¾ç½®ã€‚</p><p>ä¸ºäº†è®©flasherå·¥ä½œï¼Œä½ è¿˜éœ€è¦è®¾ç½®S32Gæ¿å­ä¸Šçš„è·³çº¿ï¼Œä½¿ä¹‹å·¥ä½œåœ¨Serial Bootæ¨¡å¼ã€‚ å¦‚æœæƒ³ç”¨eMMCï¼Œä½ éœ€è¦è°ƒæ•´J50è·³çº¿ã€‚The silk screen near the jumper describes how to set it.</p><table><thead><tr><th>Mode</th><th>SW14</th><th>SW15</th></tr></thead><tbody><tr><td>Serial Boot Mode</td><td>On-Off</td><td>Off-Off</td></tr><tr><td>Normal Boot Mode</td><td>Off-Off</td><td>Off-Off</td></tr></tbody></table><p>Flashåº“æä¾›QSPI, eMMC, SDå¡ä»¥åŠLinuxæ–‡ä»¶ç³»ç»Ÿçš„æ“¦å†™æ¥å£ï¼Œæ—¢å¯ä»¥å•ç”¨æˆ·ä½¿ç”¨æˆ–è€…ç»™è‡ªåŠ¨åŒ–å·¥å…·ä½¿ç”¨ (e.g. a Jenkins setup). é…ç½®é¡¹å¯ä»¥é€šè¿‡JSONæ–‡ä»¶æˆ–å‘½ä»¤è¡Œé€‰é¡¹è¿›è¡Œè®¾ç½®ã€‚</p><p>NXP flash toolé€šè¿‡ä¸²å£è¿›è¡Œé€šä¿¡ï¼Œu-bootå®‰è£…åå¯ä»¥é€šè¿‡fastboot/UDPé€šä¿¡ï¼ŒLinuxå®‰è£…åå¯ä»¥é€šè¿‡SSHæ–¹å¼è¿›è¡Œé€šä¿¡ã€‚ Fastbootä¼ è¾“éœ€è¦ä¸²å£é“¾æ¥åšåˆå§‹åŒ–ã€‚</p><p>ä½ å¯ä»¥ä¸€æ¬¡åªçƒ§å†™ä¸€å—å†…å­˜æˆ–è€…ä¸€ç»„å†…å­˜åŒºåŸŸã€‚</p><p>åº“æ–‡ä»¶æä¾›å›æ‰å‡½æ•°ï¼Œä»¥æ–¹ä¾¿åœ¨å†™å…¥è¿‡ç¨‹ä¸­éœ€è¦è°ƒæ•´dipå¼€å…³ã€‚</p><p>åº“æ–‡ä»¶ç”±Pythonè¯­è¨€ç¼–å†™ï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–åœ¨å…¶ä»–Pythonè„šæœ¬ä¸­è°ƒç”¨ã€‚</p><div class="custom-container tip"><p class="custom-container-title">æ³¨æ„</p><p>è„šæœ¬å·²åœ¨Linuxç¯å¢ƒæµ‹è¯•ã€‚ å¦‚æœåœ¨PATHä¸­è®¾ç½®äº†fastbootå·¥å…·ï¼ŒWindowsç¯å¢ƒä¹Ÿèƒ½å·¥ä½œã€‚</p></div><p>æ‰§è¡Œflasherè„šæœ¬çš„ <strong>å‰ææ¡ä»¶</strong> :</p><ul><li>ä¸æ¿å­ä¹‹é—´çš„ä¸²å£è¿æ¥</li><li>ä»¥å¤ªç½‘è¿æ¥ (for fastboot eMMC flashing and SSH file transfer)</li><li>é•œåƒæ–‡ä»¶ (QSPI images have to be in .s32 format)</li><li>ç»™ä¸²å£ä½¿ç”¨çš„ï¼šNXP flash tool, target application ï¼Œflash algorithm file</li><li>å·²å®‰è£…Python 3 (at least version 3.8)</li><li>éµä» <code>EBcore-main/tools/lib/python/ebcoreflashlib/JSON_flashlayout_schema.json</code> schemaçš„é…ç½®æ–‡ä»¶</li></ul><h2 id="é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> é…ç½®æ–‡ä»¶</h2><p>åŒ…å«çƒ§å†™åŒºå—ï¼Œåˆ†ç»„ï¼Œç½‘ç»œï¼Œå†…å­˜åœ°å€ç­‰ä¿¡æ¯ã€‚ é…ç½®æ–‡ä»¶é…ç½®é¡¹å¦‚ä¸‹:</p><p>flash_area:: çƒ§å†™å†…å®¹:</p><ul><li>filename: æ–‡ä»¶å</li><li>files: å¦‚æœä½¿ç”¨ <code>file_installation</code> é€‰é¡¹, åˆ™ä»£è¡¨æ–‡ä»¶åˆ—è¡¨</li><li>flash_address: èµ·å§‹åœ°å€ (ä»¥0xå¼€å¤´çš„åå…­è¿›åˆ¶æ•°, è‡³å°‘ä¸¤ä½)</li><li>mem_size: å¤§å° (ä»¥0xå¼€å¤´çš„åå…­è¿›åˆ¶æ•°, è‡³å°‘ä¸¤ä½) - only necessary for S32G targets</li><li>block_size: blockå¤§å°ï¼ŒNecessary for erasing (and consequently for writing) memory areas (hex with 0x prefix, at least two digits) - ä»…é’ˆå¯¹S32G</li><li>memory_type: <code>QSPI</code>, <code>eMMC</code>, <code>SD</code>, æˆ–è€… <code>file</code></li><li>RAM_address: RAM æ˜ å°„åœ°å€ - ä»…é’ˆå¯¹H3</li><li>supported_protocol: <code>serial</code>, <code>fastboot</code>, æˆ– <code>file_installation</code></li><li>install_script: å¦‚æœä½¿ç”¨ <code>file_installation</code> é€‰é¡¹, æ–‡ä»¶ä¼ è¾“ç»“æŸåæ‰§è¡Œçš„è„šæœ¬ flash_writer:: Renesas flash writer æˆ– NXP flash tool æ–‡ä»¶è·¯å¾„ï¼Œ è·¯å¾„æ˜¯ <code>path_to_firmware</code> çš„ç›¸å¯¹è·¯å¾„ flash_algorithms:: ä»¥JSONé”®å€¼å¯¹å½¢å¼è¡¨ç¤º, ä»£è¡¨çƒ§å†™åŒºåŸŸ/çƒ§å†™ç®—æ³•ï¼Œå…¶è·¯å¾„ä¸º <code>path_to_firmware</code> çš„ç›¸å¯¹è·¯å¾„- ä»…é’ˆå¯¹S32G target_application:: ç›®æ ‡ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å…¶è·¯å¾„ä¸º <code>path_to_firmware</code> çš„ç›¸å¯¹è·¯å¾„- ä»…é’ˆå¯¹S32G group:: JSON objects for groups, each consisting of a single list of area names. Necessary if multiple flash areas of the same type shall be flashed with one command. partition_table:: eMMC partitions, each with a name and a size. Optionally the first partition can have a start address. Only necessary for the <code>fastboot</code> flash method. path_to_firmware:: é•œåƒæ–‡ä»¶å’Œflash writerçš„baseè·¯å¾„ target_ip_address:: fastboot UDPä¼ è¾“æ—¶ä½¿ç”¨çš„IPåœ°å€ - <code>fastboot</code> æ—¶æœ‰ç”¨ target_mac_address:: ç›®æ ‡MACåœ°å€ - <code>fastboot</code> only target_username:: SSH ç™»é™†æ—¶ç”¨æˆ·å - <code>file_installation</code> only target_password:: SSH ç™»é™†æ—¶å¯†ç  - <code>file_installation</code> only target_tmp_folder:: A temporary folder on the target to store files - <code>file_installation</code> only use_external_emmc:: Whether to use external eMMC - not tested yet version:: Config file version - not necessary for flashing, but MX25UM51245G_MEM_START:: QSPI memoryèµ·å§‹åœ°å€ - S32G only MX25UM51245G_MEM_BLOCK_SIZE:: Memoryå—å¤§å° - S32G only MX25UM51245G_MEM_SIZE:: QSPI memoryå¤§å° - S32G only</li></ul><p>If a parameter is missing or specified incorrectly, it will very probably lead to an error in the flashing execution.</p><p>ç¤ºä¾‹å¯å‚è€ƒï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>EBcore-main/test/software/config/
EBcore-main/tools/lib/python/ebcoreflashlib/examples/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">æ³¨æ„</p><p>å¦‚æœä½ åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œè¯·å°† <code>path_to_firmware</code> ç•™ç©ºï¼</p></div><h2 id="å‘½ä»¤è¡Œè°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤è¡Œè°ƒç”¨" aria-hidden="true">#</a> å‘½ä»¤è¡Œè°ƒç”¨</h2><p><em>ä½¿ç”¨æ–¹æ³•:</em></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>python3 EBcore-main/tools/flasher/ebCoreFlasher.py <span class="token punctuation">\</span>
--manifest_file path_to_config_file.json <span class="token punctuation">\</span>
--flash_method method <span class="token punctuation">\</span>
<span class="token punctuation">[</span>optional parameters<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>å‚æ•°:</strong></p><p>--manifest_file:: Path to the config file. --flash_method:: Flash method to be used for the area given: <code>fastboot</code>, <code>serial</code> or <code>file_installation</code> -v, --verbose:: Set logging level to DEBUG. --target_type:: Name of the target board SoC: <code>r-car-h3</code> or <code>s32g</code> --flash_area:: Name of flash area / group to flash. --erase_emmc:: Erase eMMC using the flash_method given. Currently only serial interface is supported. --erase_qspi:: Erase QSPI using the flash_method given. Currently only serial interface is supported. --erase_sd:: Erase SD using the flash_method given. Currently only serial interface is supported. --flash_writer:: Name of the flash writer file. --target_ip_address:: IP address of the target system. --target_mac_address:: MAC address of the target system. --com_port:: Serial port to be used for the communication (default=<code>/dev/ttyUSB0</code>). --baudrate:: Serial port baudrate (default=<code>115200</code>). --path_to_firmware:: Path to the firmware files. --reboot_target:: Reboot target after flashing. --json_schema_file:: JSON schema for validating the manifest file. --json_schema_check_dry:: Don&#39;t write any memory, only validate the manifest file. --manual_callback_timeout:: Set timeout when operating the target power and dip switches manually. --hw:: Hardware description file which can be used to automate the user callbacks.</p><p>Command line parameters override those in the config file.</p><p><strong>ç¤ºä¾‹</strong><br> (assuming your working directory is <code>EBcore-main/tools/flasher</code> and the binaries are stored in <code>../../../../artifacts</code> (or similar)):</p><p>Writing QSPI firmware to H3 board:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>python3 ./ebCoreFlasher.py <span class="token punctuation">\</span>
--manifest_file <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/test/software/config/Fw_RcarH3_8GB.json <span class="token punctuation">\</span>
--flash_method serial <span class="token punctuation">\</span>
--flash_area QSPI_firmware <span class="token punctuation">\</span>
--path_to_firmware<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/artifacts <span class="token punctuation">\</span>
--target_type r-car-h3 <span class="token punctuation">\</span>
--hw /platform.json
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Writing all eMMC partitions of an H3 board: .... python3 ./ebCoreFlasher.py <br> --manifest_file ../../test/software/config/Fw_RcarH3_4GB.json <br> --flash_method fastboot <br> --target_type r-car-h3 <br> --flash_area EMMC ....</p><p>Erasing all H3 memory: .... python3 ebCoreFlasher.py <br> --manifest_file ../../test/software/config/Fw_RcarH3_4GB.json <br> --flash_method serial <br> --target_type r-car-h3 <br> --erase_emmc <br> --erase_qspi ....</p><p>Install the adaptivecore-container. Assumption: the artifacts are located in directory <code>../artifacts</code>: .... python3 ./tools/flasher/ebCoreFlasher.py <br> --manifest_file ./test/software/config/vm-alpha.json <br> --flash_method file_installation <br> --flash_area adaptivecore-container <br> --target_type r-car-h3 <br> --path_to_firmware=../../artifacts <br> ....</p><h2 id="ä½¿ç”¨pythonè„šæœ¬è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨pythonè„šæœ¬è°ƒç”¨" aria-hidden="true">#</a> ä½¿ç”¨pythonè„šæœ¬è°ƒç”¨</h2><p>Main file of the library is .... EBcore-main/tools/lib/python/ebcoreflashlib/flasher.py .... It can be used in other Python scripts like this: .... import ebcoreflashlib my_flasher = ebcoreflashlib.Flasher(manifest_file, com_port) .... Parameters are similar to those mentioned above. <code>manifest_file</code> and <code>com_port</code> are mandatory. Refer also to the docstring for detailed descriptions.</p><p>The flashing library provides the functionality to flash defined memory areas on the QSPI. There is no file system on the QSPI. The memory areas are directly addressed by a start address and a length. For eMMC flashing you can define an image which is flashed to a defined partition on the eMMC.</p><p>For modifying single files in the file system, you can use the expectSSH.py file. It provides the functionality to execute a command on the target.</p><p>Connect to the target using the expect library: .... target = ExpectSSHConsole() target.connect_and_login_to_vm(configuration) ....</p><p>Execute .... target.run(&quot;scp -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no &quot;<br> f&quot;-p {tmp_file.name} {self.user}@{self.ip}:{test_file}&quot;) .... This example copies a file from a remote host to the target. The UserKnownHostsFile is redirected to the /dev/null device. This prevents the key from being stored. The option &quot;StrictHostKeyChecking=no&quot; is used to ignore key errors. If you do not use this option you must have the correct host keys installed on the target.</p><p>[[ManualFlashingH3]]</p><h1 id="rcar-h3-firmware-æ‰‹åŠ¨çƒ§å†™" tabindex="-1"><a class="header-anchor" href="#rcar-h3-firmware-æ‰‹åŠ¨çƒ§å†™" aria-hidden="true">#</a> Rcar H3 firmware æ‰‹åŠ¨çƒ§å†™</h1><p><em>Prerequisites:</em></p><ul><li><p>Firmware binary files are available</p></li><li><p>Flash Writer from Renesas available</p></li><li><p>Linux host with Minicom terminal emulator (<code>sudo minicom -D ttyx</code>)</p></li></ul><div class="custom-container warning"><p class="custom-container-title">è­¦å‘Š</p><p>Hardware and Software Flow Control must be turned off in Minicom serial port setup.</p></div><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>Remove the board&#39;s main power before changing the mode switches. The mode switches are read by the CPLD when the board first gets power, not when turning it on by pressing the power button.</p></div><p>Step 1<br> Start Minicom. Prepare Board and flash writer:</p><ul><li><p>Put SW6(1-4) dip switch to 0100 and SW1 to off. The terminal should show the following output: .... -- Load Program to SystemRAM --------------- please send ....</p></li><li><p>Type &quot;CTRL+A S&quot; and select upload method &quot;ascii&quot;. Then choose file for uploading e.g. <code>AArch32_Flash_writer_SCIF_DUMMY_CERT_E6300400_m3ulcb.mot</code>. After upload finished press any key.</p></li></ul><p>Step 2<br> First flash the bootparam_sa0.srec. n console execute <code>xls2</code> command (load program to hyper flash) and provide the following inputs:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>
y
y
y
e6320000
<span class="token number">0</span>
<span class="token builtin class-name">type</span> <span class="token string">&quot;ctrl+A S&quot;</span> and <span class="token keyword">select</span> upload method <span class="token string">&quot;ascii&quot;</span>, <span class="token keyword">then</span> choose <span class="token function">file</span> <span class="token keyword">for</span> uploading 
<span class="token string">&quot;bootparam_sa0.srec&quot;</span>, after upload finished press any key
y
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Step 3<br> Next flash the ipl1.srec. In console execute <code>xls2</code> command (load program to hyper flash) and provide the following inputs:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>
y
y
y
e6302000
<span class="token number">40000</span>
<span class="token builtin class-name">type</span> <span class="token string">&quot;ctrl+A S&quot;</span> and <span class="token keyword">select</span> upload method <span class="token string">&quot;ascii&quot;</span>, <span class="token keyword">then</span> choose <span class="token function">file</span> <span class="token keyword">for</span> uploading 
<span class="token string">&quot;ipl1.srec&quot;</span>, after upload finished press any key
y
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Step 4<br> Next flash the bl2.srec. In console execute <code>xls2</code> command (load program to hyper flash) and provide the following inputs:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>
y
y
y
e6330000
1c0000
<span class="token builtin class-name">type</span> <span class="token string">&quot;ctrl+A S&quot;</span> and <span class="token keyword">select</span> upload method <span class="token string">&quot;ascii&quot;</span>, <span class="token keyword">then</span> choose <span class="token function">file</span> <span class="token keyword">for</span> uploading 
<span class="token string">&quot;bl2.srec&quot;</span>, after upload finished press any key
y
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Step 5<br> Next flash the bl31.srec. In console execute <code>xls2</code> command (load program to hyper flash) and provide the following inputs:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>
y
y
y
<span class="token number">44000000</span>
<span class="token number">200000</span>
<span class="token builtin class-name">type</span> <span class="token string">&quot;ctrl+A S&quot;</span> and <span class="token keyword">select</span> upload method <span class="token string">&quot;ascii&quot;</span>, <span class="token keyword">then</span> choose <span class="token function">file</span> <span class="token keyword">for</span> uploading 
<span class="token string">&quot;bl31.srec&quot;</span>, after upload finished press any key
y
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Step 6<br> Next flash the u-boot-elf-h3ulcb.srec. In console execute <code>xls2</code> command (load program to hyper flash) and provide the following inputs:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>
y
y
y
<span class="token number">50000000</span>
<span class="token number">640000</span>
<span class="token builtin class-name">type</span> <span class="token string">&quot;ctrl+A S&quot;</span> and <span class="token keyword">select</span> upload method <span class="token string">&quot;ascii&quot;</span>, <span class="token keyword">then</span> choose <span class="token function">file</span> <span class="token keyword">for</span> uploading 
<span class="token string">&quot;u-boot-elf-h3ulcb.srec&quot;</span>, after upload finished press any key
y
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Step 7<br> Put SW6(1-4) dip switch to 1010, then power off and on the hw. If the firmware is booting correctly, the output should look like this:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: DDR3200<span class="token punctuation">(</span>rev.0.37<span class="token punctuation">)</span>
NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: <span class="token punctuation">[</span>COLD_BOOT<span class="token punctuation">]</span>
NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: DRAM Split is OFF
NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: QoS is default setting<span class="token punctuation">(</span>rev.0.21<span class="token punctuation">)</span>
NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: DRAM refresh interval <span class="token number">1.95</span> usec
NOTICE:  <span class="token punctuation">(</span>IPL1<span class="token punctuation">)</span> BL2: Periodic Write DQ Training
<span class="token punctuation">[</span>    <span class="token number">0.000112</span><span class="token punctuation">]</span> NOTICE:  BL2: R-Car H3 Initial Program Loader<span class="token punctuation">(</span>CA53<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.004553</span><span class="token punctuation">]</span> NOTICE:  BL2: Initial Program Loader<span class="token punctuation">(</span>Rev.2.0.4<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.010085</span><span class="token punctuation">]</span> NOTICE:  BL2: PRR is R-Car H3 Ver.2.0
<span class="token punctuation">[</span>    <span class="token number">0.014754</span><span class="token punctuation">]</span> NOTICE:  BL2: Board is Starter Kit Rev.1.0
<span class="token punctuation">[</span>    <span class="token number">0.019851</span><span class="token punctuation">]</span> NOTICE:  BL2: Boot device is QSPI Flash<span class="token punctuation">(</span>40MHz<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.025285</span><span class="token punctuation">]</span> NOTICE:  BL2: LCM state is CM
<span class="token punctuation">[</span>    <span class="token number">0.029276</span><span class="token punctuation">]</span> NOTICE:  BL2: v1.5<span class="token punctuation">(</span>release<span class="token punctuation">)</span>:rc_1_3.0.0-dirty
<span class="token punctuation">[</span>    <span class="token number">0.034515</span><span class="token punctuation">]</span> NOTICE:  BL2: Built <span class="token builtin class-name">:</span> 09:54:45, Nov  <span class="token number">1</span> <span class="token number">2019</span>
<span class="token punctuation">[</span>    <span class="token number">0.039702</span><span class="token punctuation">]</span> NOTICE:  BL2: Normal boot
<span class="token punctuation">[</span>    <span class="token number">0.043346</span><span class="token punctuation">]</span> NOTICE:  BL2: <span class="token assign-left variable">dst</span><span class="token operator">=</span>0xe633b100 <span class="token assign-left variable">src</span><span class="token operator">=</span>0x8180000 <span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">(</span>0x200<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.049838</span><span class="token punctuation">]</span> NOTICE:  BL2: <span class="token assign-left variable">dst</span><span class="token operator">=</span>0x43f00000 <span class="token assign-left variable">src</span><span class="token operator">=</span>0x8180400 <span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token number">6144</span><span class="token punctuation">(</span>0x1800<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.057621</span><span class="token punctuation">]</span> NOTICE:  BL2: <span class="token assign-left variable">dst</span><span class="token operator">=</span>0x44000000 <span class="token assign-left variable">src</span><span class="token operator">=</span>0x8200000 <span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token number">65536</span><span class="token punctuation">(</span>0x10000<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.077097</span><span class="token punctuation">]</span> NOTICE:  BL2: <span class="token assign-left variable">dst</span><span class="token operator">=</span>0x50000000 <span class="token assign-left variable">src</span><span class="token operator">=</span>0x8640000 <span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token number">1048576</span><span class="token punctuation">(</span>0x100000<span class="token punctuation">)</span>
<span class="token punctuation">[</span>    <span class="token number">0.307195</span><span class="token punctuation">]</span> NOTICE:  BL2: Booting BL31
 
 
U-Boot <span class="token number">2018.09</span> <span class="token punctuation">(</span>Jul <span class="token number">29</span> <span class="token number">2019</span> - <span class="token number">14</span>:16:12 +0000<span class="token punctuation">)</span>
 
CPU: Renesas Electronics R8A7795 <span class="token function">rev</span> <span class="token number">2.0</span>
Model: Renesas H3ULCB board based on r8a7795 ES2.0+
DRAM:  <span class="token number">3.9</span> GiB
Bank <span class="token comment">#0: 0x048000000 - 0x07fffffff, 896 MiB</span>
Bank <span class="token comment">#1: 0x500000000 - 0x53fffffff, 1 GiB</span>
Bank <span class="token comment">#2: 0x600000000 - 0x63fffffff, 1 GiB</span>
Bank <span class="token comment">#3: 0x700000000 - 0x73fffffff, 1 GiB</span>
 
MMC:   sd@ee100000: <span class="token number">0</span>, sd@ee140000: <span class="token number">1</span>
Loading Environment from MMC<span class="token punctuation">..</span>. OK
In:    serial@e6e88000
Out:   serial@e6e88000
Err:   serial@e6e88000
Net:   eth0: ethernet@e6800000
Hit any key to stop autoboot:  <span class="token number">0</span>
<span class="token operator">=</span><span class="token operator">&gt;</span>                           
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/10/1 ä¸‹åˆ1:25:11</span></div><div class="meta-item contributors"><span class="meta-item-label">è´¡çŒ®è€…: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 827391449@qq.com">Qian Chen</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: KimChan2013@users.noreply.github.com">Qian Chen</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/ifs_shanghai_doc/assets/js/runtime~app.dd0e7869.js" defer></script><script src="/ifs_shanghai_doc/assets/js/812.60586aed.js" defer></script><script src="/ifs_shanghai_doc/assets/js/app.3beca432.js" defer></script>
  </body>
</html>
